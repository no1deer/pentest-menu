#!/usr/bin/python
#
#
#Creation Date - 03/05/2017
#Latest update added Git Pull Requests
#Last Modified - 07/06/2017
#Python Pentest Menu 
#Version 1.2


#Imports
import datetime
import os
import subprocess
import time
import shlex

#Define Colours
def prRed(prt): print("\033[91m {}\033[00m" .format(prt))
def prGreen(prt): print("\033[92m {}\033[00m" .format(prt))
def prYellow(prt): print("\033[93m {}\033[00m" .format(prt))
def prLightPurple(prt): print("\033[94m {}\033[00m" .format(prt))
def prPurple(prt): print("\033[95m {}\033[00m" .format(prt))
def prCyan(prt): print("\033[96m {}\033[00m" .format(prt))
def prLightGray(prt): print("\033[97m {}\033[00m" .format(prt))
def prBlack(prt): print("\033[98m {}\033[00m" .format(prt))

#Initally clear the screen
os.system('clear')


#Define Option 1 - NMAP Scan
def opt1():
    print "Enter the host to scan"
    option1 = raw_input(":")
    subprocess.call(['nmap', option1])
    print ""
    menu1 = raw_input("Press any key to return to the main menu")
    os.system('clear')
           
##Define Option 2 - NMAP Services Enumeration (-sV)
def opt2():
    print "What IP Would you like to enumerate?"
    ip = raw_input(":")
    subprocess.call(['nmap','-sV','-T4', ip])
    print ""
    menu_return2 = raw_input("Press any key to Return to the main menu")
    os.system('clear')

#Define Option 3 - Run Metasploit
def opt3():
    print "Loading Metasploit........."
    subprocess.call(['/usr/local/bin/msfconsole'])
    os.system('clear')

#Define Option 4 - Run BurpSuitePro
def opt4():
    print "Loading BurpSuitePro........."
    subprocess.call(['/opt/BurpSuitePro/BurpSuitePro'])
    os.system('clear')

#Define Option 5 - Run Netdiscover
def opt5():
    print "Please Enter the IP Address or Range to scan - PRESS 'ALT+q' To EXIT to Main Menu"
    netdiscover = raw_input("")
    nd = subprocess.call(['/usr/sbin/netdiscover','-r', netdiscover])
    os.system('clear')
                        
#Define Option 6 - Run Nikto
def opt6():
    print "Please enter the host or IP Address"
    nikto_input = raw_input("")
    os.system('clear')
    nikto = subprocess.call(["/opt/web-scanners/nikto/program/nikto.pl","-h", nikto_input])
    nikto_any_key = raw_input("Press Any key to Return to the main menu")
    os.system('clear')
                            
#Define Option 7 - Update Metasploit
def opt7():
    print "Updating Metasploit........"
    subprocess.call(['/usr/local/bin/msfupdate'])
    os.system('clear')
    
#Define Option 8 - Update Local System
def opt8():
    print "Running Update from Repos on Local System"
    os.system('apt-get update && apt-get upgrade')
    os.system('clear')

#Define Option 9 - Update Github Branches in /opt
def opt9():
    print "Update All Github Repos in /opt"
    git = subprocess.call('find /opt -name .git -type d | xargs -n1 -P4 -I% git --git-dir=% --work-tree=%/.. remote update -p', shell=True)
    os.system('clear')

#Define Option 10 - Display Local Network Information
def opt10():
    print "The Local Network Configuration of this OS are:"
    print ""
    ifconfig = subprocess.call(['/sbin/ifconfig'])
    dns = subprocess.call(['cat', '/etc/resolv.conf'])
    print ""
    lni_menu = raw_input("Press any Key to Continue")
    os.system('clear')
                            
    
#Define the Main Menu
def menu():
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")  
    prPurple("Please select from the following using numerical values")
    prGreen("#########################################################")
    print "                                  ", datetime.datetime.now()
    prLightPurple(" 1) System Tasks")
    prLightPurple(" 2) Application Specific Tasks")
    prLightPurple(" 3) Brute Forcers")
    prLightPurple(" 4) Enumeration Tools")
    prLightPurple(" 5) Exploitation Tools")
    prLightPurple(" 6) Evasion Tools")
    prLightPurple(" 7) Password Cracking Tools")
    prLightPurple(" 8) VPN Tools")
    prRed("11) Exit")
    

#Define System Tasks
def system_tasks():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose the appropriate website testing tool")
    print ""
    prLightPurple(" 1) Display Local Network information")
    prLightPurple(" 2) Github Branches (Update)")
    prLightPurple(" 3) Local System (Update)")
    prYellow(" 4) Back")
    system_tasks_answer = input(":")
    if system_tasks_answer ==1:
        print "The Local Network Configuration of this OS are:"
        print ""
        ifconfig = subprocess.call(['/sbin/ifconfig'])
        dns = subprocess.call(['cat', '/etc/resolv.conf'])
        print ""
        lni_menu = raw_input("Press any Key to Continue")
        system_tasks()
        os.system('clear')
    elif system_tasks_answer ==2:
        print "Update All Github Repos in /opt"
        git = subprocess.call('find /opt -name .git -type d | xargs -n1 -P4 -I% git --git-dir=% --work-tree=%/.. remote update -p', shell=True)
        system_tasks()
        os.system('clear')
    elif system_tasks_answer ==3:
        print "Running Update from Repos on Local System"
        os.system('apt-get update && apt-get upgrade')
        print ""
        local_update = raw_input("Press any key to continue")
        system_tasks()
        os.system('clear')
    elif system_tasks_answer ==4:
        os.system('clear')
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')

#Define Application Specific Tools - Level 1
def app_specific_tools_level_1():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose an applications tool")
    print ""
    prLightPurple(" 1) Wordpress Tools")
    prYellow(" 2) Back")
    app_specific_tools_level_1_answer = input(":")
    if app_specific_tools_level_1_answer ==1:
        app_specific_tools_level_2()
    elif app_specific_tools_level_1_answer ==2:
        os.system('clear')
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')
        app_specific_tools_level_1()
        
#Define Application Specific Tools - Level 2
def app_specific_tools_level_2():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose an WorddPress Sepcific tool")
    print ""
    prLightPurple(" 1) Wordpress XML RPC Brute Forcer")
    prLightPurple(" 2) WPFORCE")
    prLightPurple(" 3) WPSCAN")
    prLightPurple(" 4) WPSPLOIT")
    prLightPurple(" 5) WPWNER")
    prYellow(" 6) Back")
    app_specific_tools_level_2_answer = input(":")
    if app_specific_tools_level_2_answer ==1:
        try:
            app = "./tools/2-application-specific-tools/wordpress/Wordpress-XMLRPC-Brute-Force-Exploit/wordpress-xmlrpc-brute.py"
            app_split = shlex.split(app)
            print "Enter XML File path followed by Wordlist followed by usename with spaces in between each"
            command_line1 = raw_input()
            xml_args = shlex.split(command_line1)
            wordlist = "./wordlists/SecLists/Passwords/rockyou.txt"
            ws_args = shlex.split(wordlist)
            print "Enter the name of the user to test"
            command_line2 = raw_input()
            user_args = shlex.split(command_line2)
            s = app_split + xml_args + ws_args + user_args
            x = subprocess.call(s)
            raw_input("Press any key to return to the menu")
            os.system('clear')
            app_specific_tools_level_2()
        except KeyboardInterrupt:
#           sys.tracebacklimit = 0
            os.system('clear')
            app_specific_tools_level_2()
    elif app_specific_tools_level_2_answer ==2:
        print "add full path2"
        os.system('clear')
    elif app_specific_tools_level_2_answer ==3:
        print "add full path3"
        os.system('clear')
    elif app_specific_tools_level_2_answer ==4:
        print "add full path4"
        os.system('clear')
    elif app_specific_tools_level_2_answer ==5:
        print "add full path5"
        os.system('clear')
    elif app_specific_tools_level_2_answer ==6:
        app_specific_tools_level_1
        os.system('clear')
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')
#Define 1)
def test():
    print "Enter a name"
    test = raw_input(":")
    print test

        
#Define Brute Forcers Menu
def brute_forcers():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose the appropriate Brute Force testing tool")
    print ""
    prLightPurple(" 1) Medusa")
    prLightPurple(" 2) Patator")
    prYellow(" 3) Back")
    brute_forcers_answer = input(":")
    if brute_forcers_answer ==1:
        print "add full path1"
        os.system('clear')
    elif brute_forcers_answer ==2:
        print "add full path2"
        os.system('clear')
    elif brute_forcers_answer ==3:
        menu()
        os.system('clear')
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')

#Define Enumeration Tools
def enumeration_tools():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose the appropriate Brute Force testing tool")
    print ""
    prLightPurple(" 1) Database Tools")
    prLightPurple(" 2) Dir Buster")
    prLightPurple(" 3) The Harvester")
    prLightPurple(" 4) Mass Scan")
    prLightPurple(" 5) Multi Purpose Tools")
    prLightPurple(" 6) NMAP")
    prLightPurple(" 7) Osueta")
    prLightPurple(" 8) Paros")
    prLightPurple(" 9) Recon-ng")
    prLightPurple("10) Wafw00f")
    prLightPurple("11) Website Tools")
    prYellow("12) Back")
    enumeration_answer = input(":")
    if enumeration_answer ==1:
        os.system('clear')
        database_menu()
    elif enumeration_answer ==2:
        print "Run Dir Buster"
    elif enumeration_answer ==3:
        print "Run the Harvester"
    elif enumeration_answer ==4:
        print "Run Mass Scan"
    elif enumeration_answer ==5:
        os.system('clear')
        multi_tool_menu()
    elif enumeration_answer ==6:
        print "NMAP"
    elif enumeration_answer ==7:
        print "Osueta"
    elif enumeration_answer ==8:
        print "Paros"
    elif enumeration_answer ==9:
        print "Recon-ng"
    elif enumeration_answer ==10:
        print "wafw00f"
    elif enumeration_answer ==11:
        website_tools_menu()
    elif enumeration_answer ==12:
        menu()
        os.system('clear')
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')
        database()

#Database Tools
def database_menu():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose the appropriate Database Testing Tool")
    print ""
    prLightPurple(" 1) Odat - Oracle Database Attacking Tool")
    prYellow(" 2) Back")
    database_answer = input(":")
    if database_answer ==1:
        print "Odat Menu"
    elif database_answer ==2:
        enumeration_tools()
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')
        
#Multi Tools Menu
def multi_tool_menu():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose the appropriate Database Testing Tool")
    print ""
    prLightPurple(" 1) Patator")
    prYellow(" 2) Back")
    multi_tool_answer = input(":")
    if multi_tool_answer ==1:
        print "Run Patator"
    elif multi_tool_answer ==2:
        enumeration_tools()
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')

#Website Tools
def website_tools_menu():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose the appropriate Website Enumeration Tools")
    print ""
    prLightPurple(" 1) b374k")
    prLightPurple(" 2) Weevely3")
    prLightPurple(" 3) wfuzz")
    prYellow(" 4) Back")
    website_tools_menu_answer = input(":")
    if website_tools_menu_answer ==1:
        print "Run b374k"
    elif website_tools_menu_answer ==2:
        print "Run Weevely3"
    elif website_tools_menu_answer ==3:
        print "Run wfuzz"
    elif website_tools_menu_answer ==4:
        os.system('clear')
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')

#Exploitation Tools Menu
def exploitation_tools_menu():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose the appropriate Exploit")
    print ""
    prLightPurple(" 1) Metasploit Framework")
    prLightPurple(" 2) w3af - Web Application & Audit Framework")
    prLightPurple(" 3) sqlmap")
    prYellow(" 4) Back")
    exploitation_tools_answer = input(":")
    if exploitation_tools_answer ==1:
        subprocess.call(['./tools/5-exploitation-tools/metasploit-framework/msfupdate'])
        subprocess.call(['./tools/5-exploitation-tools/metasploit-framework/msfconsole'])
        exploitation_tools_menu()
        os.system('clear')
    elif exploitation_tools_answer ==2:
        print "Run w3af"
    elif exploitation_tools_answer ==3:
        print "Run sqlmap"
    elif exploitation_tools_answer ==4:
        os.system('clear')
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')

#Evasion Tools
def evasion_tools_menu():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose the appropriate Evasion Tools")
    print ""
    prLightPurple(" 1) Majic Unicorn")
    prYellow(" 2) Back")
    evasion_tools_answer = input(":")
    if evasion_tools_answer ==1:
        print "Run Patator"
    elif evasion_tools_answer ==2:
        os.system('clear')
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')

#Password Cracking Tools
def password_cracking_tools_menu():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose the Password Cracking Tools")
    print ""
    prLightPurple(" 1) JohnTheRipper")
    prYellow(" 2) Back")
    password_cracking_answer = input(":")
    if password_cracking_answer ==1:
        print "Run John The Ripper"
    elif password_cracking_answer ==2:
        os.system('clear')
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')
#VPN Tools Menu
def vpn_tools_menu():
    os.system('clear')
    prGreen("#########################################################")
    prPurple("Welcome to the t0ast Pentest Menu!")
    prPurple("Choose the VPN Tools Menu Tools")
    print ""
    prLightPurple(" 1) ikeforce")
    prLightPurple(" 2) ike-scan")
    prYellow(" 3) Back")
    vpn_tools_answer = input(":")
    if vpn_tools_answer ==1:
        print "Run ikeforce"
    elif vpn_tools_answer ==2:
        print "Run ikescan"
    elif vpn_tools_answer ==3:
        os.system('clear')
    else:
        raw_input("You did not give a valid answer, press any key to try again")
        os.system('clear')
        
                                                        
        
loop=True

while loop:
    print menu()
    mm_answer = input(":")

    if mm_answer ==1:
        system_tasks()
    elif mm_answer ==2:
        app_specific_tools_level_1()
    elif mm_answer ==3:
        brute_forcers()
    elif mm_answer ==4:
        enumeration_tools()
    elif mm_answer ==5:
        exploitation_tools_menu()
    elif mm_answer ==6:
        evasion_tools_menu()
    elif mm_answer ==7:
        password_cracking_tools_menu()
    elif mm_answer ==8:
        vpn_tools_menu()
    elif mm_answer ==9:
        opt9()
    elif mm_answer ==10:
        opt10()
    elif mm_answer ==11:
        break
    elif mm_answer ==20:
        website_menu()
    else:
        raw_input("You did not give a valid answer, press any key to try again") 
        os.system('clear')

